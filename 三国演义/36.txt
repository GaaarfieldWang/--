曹叡见夏侯楙兵败，孔明连得三郡，十分惊慌，忙命曹真、郭淮率兵拒敌。经过祁山几场大战，曹真、郭淮又败。曹叡只得起用司马懿官复原职，加平西都督，准备领兵出征。

	 

	却说孟达降魏之后，曹丕待他甚厚，曹叡即位，朝中许多人忌妒孟达，孟达日夜不安。

	 

	此时见诸葛亮大军势如破竹，孟达便差心腹来见诸葛亮，要助丞相伐魏。诸葛亮得知司马懿重掌兵权，便叫孟达小心提防。孟达却不以为意，约了金城太守申仪、上庸太守申耽，不日起事。二人表面应允，暗地里却报知了朝廷。

	 

	司马懿得知孟达要反，便会同徐晃，日夜兼程来取新城。徐晃先到，被孟达一箭射中额头，伤重而死。司马懿随后赶到，将新城围住。孟达着了慌，忽然见城外申仪、申耽引兵而来，只道救兵到，便开城门杀出，却被申耽一枪刺于马下。司马懿破了孟达，便命张郃为先锋，从长安出兵，去助曹真。

	 

	诸葛亮得知司马懿破了孟达，大惊道：“司马懿出关，必取街亭，断我咽喉之路。”便问：“谁敢引兵去守街亭？”话音未落，参军马谡道：“某愿往。”诸葛亮道：“街亭虽小，干系甚大。此地既无城郭，又无险阻，守之极难。”马谡道：“我自幼熟读兵书，怎会守不住小小街亭！”说罢，立了军令状。诸葛亮仍不放心，又派王平相助，要他小心谨慎，当道扎寨；安营之后，画成图本报知大营，不得有失。

	 

	二人引兵去了。诸葛亮怕二人有失，又命高翔引一军守列柳城，魏延引一军守阳平关，以便救应。诸葛亮又命赵云、邓芝引军出箕谷，作为疑兵。

	 

	马谡、王平二人兵到街亭，看了地势。马谡笑道：“丞相何必多心，如此偏僻小路，魏军如何敢来？”王平劝他在路口下寨，让魏兵不能轻易通过，马谡不以为然，笑道：“侧边有一山，乃天赐之险。兵法云：‘居高临下，势如破竹。’若魏兵到来，叫他片甲不回！”王平苦劝，马谡道：“丞相有事还要问我，你为何不听号令！”王平无奈，只得领五千兵屯扎当道；画了图本，星夜去禀诸葛亮。

	 

	司马懿在城中探知马谡在山上屯兵，大喜，便命张郃引一军挡住王平来路，又令四下围住山脚，切断蜀军水源。蜀军见山下魏兵漫山遍野，旌旗蔽日，都不敢下山。马谡将红旗招动，将士无一人敢动。马谡大怒，连杀二将。众军惊恐，只得努力下山来冲魏兵，却哪里冲得动！马谡无奈只得闭寨门，等待外应。王平见魏兵杀来，要来救援，却被张郃拦住，只得退去。

	 

	围到半夜，山上无水，蜀军寨中大乱，不少人下山降了魏军。马谡禁止不住。司马懿又令人沿山放火，山上愈乱。马谡料想守不住，只得领残兵杀下山来，向西奔逃。司马懿放条大路，让过马谡，只让张郃追赶。赶了三十里，魏延杀出，直取张郃。张郃引军便走。魏延正要起来重夺街亭，四下伏兵齐出，将他困在垓心。幸好王平杀到，救了魏延，投奔列柳城。

	 

	高翔得知街亭有失，正起兵前来救应，却遇着魏延、王平二人。三人商议重夺街亭，便兵分三路，来战魏兵。魏军伏兵又出，三人只得回奔列柳城，却见城上已竖起魏将郭淮旗号。三人无奈，只得回守阳平关。司马懿也不追赶，只向西城进兵。

	 

	却说诸葛亮接到王平图本，大惊道：“马谡无知，害我大军！”急忙命杨仪去替马谡。杨仪正要上路，探马来报，街亭、列柳城皆已失守。诸葛亮长叹道：“大势去矣！”只得吩咐众将分守各路关口，依计行事，准备退兵。诸葛亮自带五千兵到了西城，搬运粮草。

	 

	忽然飞马来报：“司马懿率十五万大军，往西城蜂拥而来！”此时诸葛亮身边别无大将，只有一班文官，所带五千军已有一半先运粮草去了。众官听得消息，大惊失色。诸葛亮登城一望，果然尘土冲天。诸葛亮便传令：隐藏旌旗；军士藏在营中，如有高声言语及妄自出入者，斩首；大开四门，每门用二十士兵扮成百姓，洒扫街道。诸葛亮自引二小童，到城上敌楼前焚香安坐，从容弹琴。

	 

	魏军到了城下，见如此模样，都不敢进，急报司马懿。司马懿亲自来看，见诸葛亮笑容可掬，焚香操琴，心中大疑。回到中军，便让后军做前军，往北山路而退。次子司马昭道：“莫非诸葛亮并无兵马？”司马懿道：“诸葛亮平生谨慎，不曾冒险。如今大开城门，必有埋伏。我军若进，定然中计。”

	 

	诸葛亮见魏军退尽，拍掌而笑。众官惊魂未定，问魏军为何退兵。诸葛亮道：“司马懿料我生平谨慎，必不弄险；见如此模样，怀疑城中有伏兵，因此退去。”

	 

	司马懿正往小路退兵，忽然张苞、关兴杀出，更是心疑，慌忙领兵退走。二人也不追赶。曹真探知诸葛亮退兵，急来追赶。山后一声炮响，姜维、马岱杀出，曹真只得退兵。赵云守住箕谷，一一杀败来将，邓芝引兵缓缓退走。蜀兵退后，司马懿占了西城。找了山民来问，才知诸葛亮当日只有两千五百军马，司马懿懊悔不已。

	 

	诸葛亮回到汉中，马谡自缚跪于帐前。诸葛亮变色道：“你自幼熟读兵书，我多次告诫：街亭是我根本。你以全家性命担保领此重任。若早听王平之言，岂会有此祸？如今损兵折将，失地陷城，都是你之过错！若不明正军法，何以服众？你今犯法，休得怨我。你死之后，家人老小，我会按月给予俸禄，你不必挂心。”于是令左右将马谡推出斩之。马谡哭道：“丞相待我如子，我也以丞相为父。如今我死罪难逃，愿丞相照顾我子，我虽死亦无恨于九泉！”诸葛亮挥泪道：“我与你情同兄弟，你之子即我之子，不必多嘱。”左右将马谡推出辕门外要斩，此时参军蒋琬从成都赶到，见此大惊，高叫：“留人！”入见诸葛亮道：“今天下未定，而杀智谋之臣，岂不可惜？”诸葛亮流泪答道：“昔日孙武所以能致胜天下，是以为法律严明。如今四方纷争，若废了法度，何以讨贼啊？只得斩之。”

	 

	片刻，武士献马谡首级于阶下。诸葛亮大哭不已。蒋琬问：“如今马谡既已正了军法，丞相何故痛哭啊？”诸葛亮道：“我想先帝在白帝城托孤时曾嘱咐我‘马谡言过其实，不可大用’，如今果应了此言。我深恨自己不明，追思先帝遗言，因此痛哭！”帐上大小将士，无不流泪。

	 

	诸葛亮又上表后主，请求自贬三等。后主便贬诸葛亮为右将军，行丞相事，照旧总督兵马。

	 

	诸葛亮在汉中，惜军爱民，聚积粮食，以图再进。